// Professional email service using Resend for Myowntour
import { Resend } from 'resend';

// Initialize Resend with API key
const resend = new Resend(import.meta.env.VITE_RESEND_API_KEY);

export interface EmailTemplate {
  to: string;
  subject: string;
  html: string;
  text: string;
}

export interface WelcomeEmailData {
  email: string;
  firstName: string;
  lastName: string;
  role: 'client' | 'guide' | 'tour_operator';
}

export interface BookingEmailData {
  email: string;
  firstName: string;
  lastName: string;
  bookingId: string;
  excursionName: string;
  date: string;
  time: string;
  participants: number;
  totalPrice: number;
  guideName: string;
  guidePhone: string;
  meetingPoint: string;
}

export interface ReminderEmailData {
  email: string;
  firstName: string;
  lastName: string;
  excursionName: string;
  date: string;
  time: string;
  meetingPoint: string;
  guideName: string;
  guidePhone: string;
}

export class ResendEmailService {
  // Send welcome email based on user role
  static async sendWelcomeEmail(userData: WelcomeEmailData): Promise<boolean> {
    try {
      const { email, firstName, lastName, role } = userData;
      
      let subject = '';
      let html = '';
      let text = '';

      switch (role) {
        case 'client':
          subject = 'üå¥ Bienvenue sur Myowntour - Votre compte est activ√© !';
          html = this.getClientWelcomeHTML(firstName, lastName);
          text = this.getClientWelcomeText(firstName, lastName);
          break;
        case 'guide':
          subject = 'ü§ù Bienvenue guide Myowntour - Votre compte est activ√© !';
          html = this.getGuideWelcomeHTML(firstName, lastName);
          text = this.getGuideWelcomeText(firstName, lastName);
          break;
        case 'tour_operator':
          subject = 'ü§ù Bienvenue tour-op√©rateur Myowntour - Votre compte est activ√© !';
          html = this.getTourOperatorWelcomeHTML(firstName, lastName);
          text = this.getTourOperatorWelcomeText(firstName, lastName);
          break;
      }

      const result = await resend.emails.send({
        from: 'Myowntour <noreply@myowntour.com>',
        to: [email],
        subject,
        html,
        text,
      });

      console.log('‚úÖ Welcome email sent successfully:', result);
      return true;
    } catch (error) {
      console.error('‚ùå Error sending welcome email:', error);
      return false;
    }
  }

  // Send booking confirmation email
  static async sendBookingConfirmationEmail(bookingData: BookingEmailData): Promise<boolean> {
    try {
      const { email, firstName, lastName, excursionName, date, time, participants, totalPrice, guideName, guidePhone, meetingPoint } = bookingData;

      const subject = 'üéØ Confirmation de r√©servation - Myowntour';
      const html = this.getBookingConfirmationHTML(bookingData);
      const text = this.getBookingConfirmationText(bookingData);

      const result = await resend.emails.send({
        from: 'Myowntour <bookings@myowntour.com>',
        to: [email],
        subject,
        html,
        text,
      });

      console.log('‚úÖ Booking confirmation email sent successfully:', result);
      return true;
    } catch (error) {
      console.error('‚ùå Error sending booking confirmation email:', error);
      return false;
    }
  }

  // Send 24h reminder email
  static async sendReminderEmail(reminderData: ReminderEmailData): Promise<boolean> {
    try {
      const { email, firstName, lastName, excursionName, date, time, meetingPoint, guideName, guidePhone } = reminderData;

      const subject = '‚è∞ Rappel - Votre excursion demain - Myowntour';
      const html = this.getReminderHTML(reminderData);
      const text = this.getReminderText(reminderData);

      const result = await resend.emails.send({
        from: 'Myowntour <reminders@myowntour.com>',
        to: [email],
        subject,
        html,
        text,
      });

      console.log('‚úÖ Reminder email sent successfully:', result);
      return true;
    } catch (error) {
      console.error('‚ùå Error sending reminder email:', error);
      return false;
    }
  }

  // Send password reset email
  static async sendPasswordResetEmail(email: string, resetToken: string): Promise<boolean> {
    try {
      const resetUrl = `https://myowntour.app/reset-password?token=${resetToken}`;
      
      const subject = 'üîê R√©initialisation de votre mot de passe Myowntour';
      const html = this.getPasswordResetHTML(resetUrl);
      const text = this.getPasswordResetText(resetUrl);

      const result = await resend.emails.send({
        from: 'Myowntour <security@myowntour.com>',
        to: [email],
        subject,
        html,
        text,
      });

      console.log('‚úÖ Password reset email sent successfully:', result);
      return true;
    } catch (error) {
      console.error('‚ùå Error sending password reset email:', error);
      return false;
    }
  }

  // Client welcome email HTML
  private static getClientWelcomeHTML(firstName: string, lastName: string): string {
    return `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bienvenue sur Myowntour</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 10px 10px; }
          .button { display: inline-block; background: #667eea; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; margin: 20px 0; }
          .feature { background: white; padding: 20px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #667eea; }
          .footer { text-align: center; margin-top: 30px; color: #666; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>üå¥ Bienvenue sur Myowntour !</h1>
          <p>Votre compte client est activ√©</p>
        </div>
        <div class="content">
          <h2>Bonjour ${firstName} ${lastName} !</h2>
          <p>F√©licitations ! Votre compte client Myowntour a √©t√© cr√©√© et activ√© avec succ√®s. Vous pouvez maintenant d√©couvrir et r√©server les plus belles excursions de Martinique.</p>
          
          <div class="feature">
            <h3>‚úÖ Votre compte est imm√©diatement utilisable</h3>
            <p>Aucune confirmation suppl√©mentaire requise !</p>
          </div>

          <h3>üéØ Ce que vous pouvez faire maintenant :</h3>
          <div class="feature">
            <strong>üèñÔ∏è Parcourir nos excursions</strong><br>
            Plages, randonn√©es, culture - d√©couvrez la Martinique
          </div>
          <div class="feature">
            <strong>üìÖ R√©server vos activit√©s pr√©f√©r√©es</strong><br>
            R√©servation simple et s√©curis√©e en quelques clics
          </div>
          <div class="feature">
            <strong>üí¨ Laisser des avis</strong><br>
            Partagez vos exp√©riences apr√®s vos aventures
          </div>
          <div class="feature">
            <strong>üì± G√©rer vos r√©servations</strong><br>
            Tableau de bord complet pour suivre vos activit√©s
          </div>

          <p>Nos guides locaux passionn√©s vous feront d√©couvrir les tr√©sors cach√©s de l'√Æle aux fleurs.</p>

          <div style="text-align: center;">
            <a href="https://myowntour.app" class="button">üöÄ Commencer maintenant</a>
          </div>

          <div class="footer">
            <p><strong>Besoin d'aide ?</strong><br>
            üìß contact@myowntour.com<br>
            üìû +596 696 XX XX XX</p>
            <p>Merci de nous faire confiance pour vos aventures martiniquaises !<br>
            <strong>L'√©quipe Myowntour</strong></p>
          </div>
        </div>
      </body>
      </html>
    `;
  }

  // Client welcome email text
  private static getClientWelcomeText(firstName: string, lastName: string): string {
    return `
Bonjour ${firstName} ${lastName} !

F√©licitations ! Votre compte client Myowntour a √©t√© cr√©√© et activ√© avec succ√®s. 
Vous pouvez maintenant d√©couvrir et r√©server les plus belles excursions de Martinique.

‚úÖ Votre compte est imm√©diatement utilisable - aucune confirmation suppl√©mentaire requise !

üéØ Ce que vous pouvez faire maintenant :
‚Ä¢ üèñÔ∏è Parcourir nos excursions (plages, randonn√©es, culture)
‚Ä¢ üìÖ R√©server vos activit√©s pr√©f√©r√©es
‚Ä¢ üí¨ Laisser des avis apr√®s vos exp√©riences
‚Ä¢ üì± G√©rer vos r√©servations depuis votre tableau de bord

Nos guides locaux passionn√©s vous feront d√©couvrir les tr√©sors cach√©s de l'√Æle aux fleurs.

üöÄ Connectez-vous maintenant : https://myowntour.app

Besoin d'aide ?
üìß contact@myowntour.com
üìû +596 696 XX XX XX

Merci de nous faire confiance pour vos aventures martiniquaises !

L'√©quipe Myowntour
    `;
  }

  // Guide welcome email HTML
  private static getGuideWelcomeHTML(firstName: string, lastName: string): string {
    return `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bienvenue guide Myowntour</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 10px 10px; }
          .button { display: inline-block; background: #28a745; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; margin: 20px 0; }
          .feature { background: white; padding: 20px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #28a745; }
          .footer { text-align: center; margin-top: 30px; color: #666; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>ü§ù Bienvenue guide Myowntour !</h1>
          <p>Votre compte guide est activ√©</p>
        </div>
        <div class="content">
          <h2>Bonjour ${firstName} ${lastName} !</h2>
          <p>F√©licitations ! Votre compte guide Myowntour a √©t√© cr√©√© et activ√© avec succ√®s. Vous rejoignez notre r√©seau de guides locaux passionn√©s.</p>
          
          <div class="feature">
            <h3>‚úÖ Votre compte est imm√©diatement utilisable</h3>
            <p>Aucune confirmation suppl√©mentaire requise !</p>
          </div>

          <h3>üíº Vos avantages guide :</h3>
          <div class="feature">
            <strong>üí∞ Commission de seulement 15%</strong><br>
            La plus comp√©titive du march√©
          </div>
          <div class="feature">
            <strong>üéØ Visibilit√© accrue</strong><br>
            Sur notre plateforme de r√©f√©rence
          </div>
          <div class="feature">
            <strong>üìä Outils de gestion</strong><br>
            R√©servations et planning int√©gr√©s
          </div>
          <div class="feature">
            <strong>üí≥ Paiements s√©curis√©s</strong><br>
            Automatis√©s et fiables
          </div>
          <div class="feature">
            <strong>üìà Statistiques d√©taill√©es</strong><br>
            Suivez votre performance
          </div>

          <h3>üöÄ Prochaines √©tapes :</h3>
          <ol>
            <li>Compl√©tez votre profil - Ajoutez vos informations d'entreprise</li>
            <li>Cr√©ez vos excursions - Pr√©sentez vos activit√©s</li>
            <li>D√©finissez vos cr√©neaux - G√©rez votre planning</li>
            <li>Attendez la validation - Notre √©quipe v√©rifiera votre profil</li>
          </ol>

          <div style="text-align: center;">
            <a href="https://myowntour.app" class="button">üöÄ Commencer maintenant</a>
          </div>

          <div class="footer">
            <p><strong>Support partenaire :</strong><br>
            üìß partenaires@myowntour.com<br>
            üìû +596 696 XX XX XX<br>
            üí¨ Chat en direct depuis votre tableau de bord</p>
            <p>Ensemble, faisons d√©couvrir les merveilles de la Martinique !<br>
            <strong>L'√©quipe Myowntour</strong></p>
          </div>
        </div>
      </body>
      </html>
    `;
  }

  // Guide welcome email text
  private static getGuideWelcomeText(firstName: string, lastName: string): string {
    return `
Bonjour ${firstName} ${lastName} !

F√©licitations ! Votre compte guide Myowntour a √©t√© cr√©√© et activ√© avec succ√®s. 
Vous rejoignez notre r√©seau de guides locaux passionn√©s.

‚úÖ Votre compte est imm√©diatement utilisable - aucune confirmation suppl√©mentaire requise !

üíº Vos avantages guide :
‚Ä¢ üí∞ Commission de seulement 15% (la plus comp√©titive)
‚Ä¢ üéØ Visibilit√© accrue sur notre plateforme
‚Ä¢ üìä Outils de gestion des r√©servations
‚Ä¢ üí≥ Paiements s√©curis√©s automatis√©s
‚Ä¢ üìà Statistiques d√©taill√©es de performance

üöÄ Prochaines √©tapes :
1. Compl√©tez votre profil - Ajoutez vos informations d'entreprise
2. Cr√©ez vos excursions - Pr√©sentez vos activit√©s
3. D√©finissez vos cr√©neaux - G√©rez votre planning
4. Attendez la validation - Notre √©quipe v√©rifiera votre profil

üöÄ Connectez-vous maintenant : https://myowntour.app

Support partenaire :
üìß partenaires@myowntour.com
üìû +596 696 XX XX XX
üí¨ Chat en direct depuis votre tableau de bord

Ensemble, faisons d√©couvrir les merveilles de la Martinique !

L'√©quipe Myowntour
    `;
  }

  // Tour operator welcome email HTML
  private static getTourOperatorWelcomeHTML(firstName: string, lastName: string): string {
    return `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bienvenue tour-op√©rateur Myowntour</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: linear-gradient(135deg, #fd7e14 0%, #e83e8c 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 10px 10px; }
          .button { display: inline-block; background: #fd7e14; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; margin: 20px 0; }
          .feature { background: white; padding: 20px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #fd7e14; }
          .footer { text-align: center; margin-top: 30px; color: #666; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>ü§ù Bienvenue tour-op√©rateur Myowntour !</h1>
          <p>Votre compte tour-op√©rateur est activ√©</p>
        </div>
        <div class="content">
          <h2>Bonjour ${firstName} ${lastName} !</h2>
          <p>F√©licitations ! Votre compte tour-op√©rateur Myowntour a √©t√© cr√©√© et activ√© avec succ√®s. Vous rejoignez notre r√©seau de revendeurs professionnels.</p>
          
          <div class="feature">
            <h3>‚úÖ Votre compte est imm√©diatement utilisable</h3>
            <p>Aucune confirmation suppl√©mentaire requise !</p>
          </div>

          <h3>üíº Vos avantages tour-op√©rateur :</h3>
          <div class="feature">
            <strong>üéØ Acc√®s √† toutes les excursions</strong><br>
            De nos guides partenaires
          </div>
          <div class="feature">
            <strong>üí∞ Marge attractive</strong><br>
            Sur chaque vente
          </div>
          <div class="feature">
            <strong>üìä Outils de gestion</strong><br>
            R√©servations clients int√©gr√©es
          </div>
          <div class="feature">
            <strong>üí≥ Paiements s√©curis√©s</strong><br>
            Automatis√©s et fiables
          </div>
          <div class="feature">
            <strong>üìà Statistiques d√©taill√©es</strong><br>
            Suivez votre performance
          </div>

          <h3>üöÄ Prochaines √©tapes :</h3>
          <ol>
            <li>Compl√©tez votre profil - Ajoutez vos informations d'entreprise</li>
            <li>Parcourez le catalogue - D√©couvrez les excursions disponibles</li>
            <li>Commencez √† vendre - Proposez les excursions √† vos clients</li>
            <li>Attendez la validation - Notre √©quipe v√©rifiera votre profil</li>
          </ol>

          <div style="text-align: center;">
            <a href="https://myowntour.app" class="button">üöÄ Commencer maintenant</a>
          </div>

          <div class="footer">
            <p><strong>Support tour-op√©rateurs :</strong><br>
            üìß partenaires@myowntour.com<br>
            üìû +596 696 XX XX XX<br>
            üí¨ Chat en direct depuis votre tableau de bord</p>
            <p>Ensemble, d√©veloppons le tourisme martiniquais !<br>
            <strong>L'√©quipe Myowntour</strong></p>
          </div>
        </div>
      </body>
      </html>
    `;
  }

  // Tour operator welcome email text
  private static getTourOperatorWelcomeText(firstName: string, lastName: string): string {
    return `
Bonjour ${firstName} ${lastName} !

F√©licitations ! Votre compte tour-op√©rateur Myowntour a √©t√© cr√©√© et activ√© avec succ√®s. 
Vous rejoignez notre r√©seau de revendeurs professionnels.

‚úÖ Votre compte est imm√©diatement utilisable - aucune confirmation suppl√©mentaire requise !

üíº Vos avantages tour-op√©rateur :
‚Ä¢ üéØ Acc√®s √† toutes les excursions de nos guides
‚Ä¢ üí∞ Marge attractive sur chaque vente
‚Ä¢ üìä Outils de gestion des r√©servations clients
‚Ä¢ üí≥ Paiements s√©curis√©s automatis√©s
‚Ä¢ üìà Statistiques d√©taill√©es de performance

üöÄ Prochaines √©tapes :
1. Compl√©tez votre profil - Ajoutez vos informations d'entreprise
2. Parcourez le catalogue - D√©couvrez les excursions disponibles
3. Commencez √† vendre - Proposez les excursions √† vos clients
4. Attendez la validation - Notre √©quipe v√©rifiera votre profil

üöÄ Connectez-vous maintenant : https://myowntour.app

Support tour-op√©rateurs :
üìß partenaires@myowntour.com
üìû +596 696 XX XX XX
üí¨ Chat en direct depuis votre tableau de bord

Ensemble, d√©veloppons le tourisme martiniquais !

L'√©quipe Myowntour
    `;
  }

  // Booking confirmation email HTML
  private static getBookingConfirmationHTML(bookingData: BookingEmailData): string {
    const { firstName, lastName, excursionName, date, time, participants, totalPrice, guideName, guidePhone, meetingPoint } = bookingData;
    
    return `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Confirmation de r√©servation</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 10px 10px; }
          .booking-details { background: white; padding: 25px; margin: 20px 0; border-radius: 8px; border: 2px solid #28a745; }
          .detail-row { display: flex; justify-content: space-between; margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px; }
          .detail-label { font-weight: bold; color: #495057; }
          .detail-value { color: #212529; }
          .total { background: #28a745; color: white; font-weight: bold; font-size: 18px; }
          .footer { text-align: center; margin-top: 30px; color: #666; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>üéØ R√©servation confirm√©e !</h1>
          <p>Votre excursion est r√©serv√©e</p>
        </div>
        <div class="content">
          <h2>Bonjour ${firstName} ${lastName} !</h2>
          <p>Votre r√©servation a √©t√© confirm√©e avec succ√®s. Voici les d√©tails de votre excursion :</p>
          
          <div class="booking-details">
            <h3>üìã D√©tails de la r√©servation</h3>
            <div class="detail-row">
              <span class="detail-label">üèñÔ∏è Excursion :</span>
              <span class="detail-value">${excursionName}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üìÖ Date :</span>
              <span class="detail-value">${date}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">‚è∞ Heure :</span>
              <span class="detail-value">${time}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üë• Participants :</span>
              <span class="detail-value">${participants} personne(s)</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üë®‚Äçüè´ Guide :</span>
              <span class="detail-value">${guideName}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üìû Contact guide :</span>
              <span class="detail-value">${guidePhone}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üìç Point de rendez-vous :</span>
              <span class="detail-value">${meetingPoint}</span>
            </div>
            <div class="detail-row total">
              <span class="detail-label">üí∞ Total :</span>
              <span class="detail-value">${totalPrice}‚Ç¨</span>
            </div>
          </div>

          <div style="background: #fff3cd; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107; margin: 20px 0;">
            <h4>‚ö†Ô∏è Important :</h4>
            <ul>
              <li>Pr√©sentez-vous 15 minutes avant l'heure de d√©part</li>
              <li>Apportez une pi√®ce d'identit√©</li>
              <li>En cas d'annulation, contactez-nous 24h √† l'avance</li>
              <li>Votre guide vous contactera la veille pour confirmer</li>
            </ul>
          </div>

          <div class="footer">
            <p><strong>Besoin d'aide ?</strong><br>
            üìß contact@myowntour.com<br>
            üìû +596 696 XX XX XX</p>
            <p>Merci de votre confiance !<br>
            <strong>L'√©quipe Myowntour</strong></p>
          </div>
        </div>
      </body>
      </html>
    `;
  }

  // Booking confirmation email text
  private static getBookingConfirmationText(bookingData: BookingEmailData): string {
    const { firstName, lastName, excursionName, date, time, participants, totalPrice, guideName, guidePhone, meetingPoint } = bookingData;
    
    return `
Bonjour ${firstName} ${lastName} !

Votre r√©servation a √©t√© confirm√©e avec succ√®s. Voici les d√©tails de votre excursion :

üìã D√âTAILS DE LA R√âSERVATION
üèñÔ∏è Excursion : ${excursionName}
üìÖ Date : ${date}
‚è∞ Heure : ${time}
üë• Participants : ${participants} personne(s)
üë®‚Äçüè´ Guide : ${guideName}
üìû Contact guide : ${guidePhone}
üìç Point de rendez-vous : ${meetingPoint}
üí∞ Total : ${totalPrice}‚Ç¨

‚ö†Ô∏è IMPORTANT :
‚Ä¢ Pr√©sentez-vous 15 minutes avant l'heure de d√©part
‚Ä¢ Apportez une pi√®ce d'identit√©
‚Ä¢ En cas d'annulation, contactez-nous 24h √† l'avance
‚Ä¢ Votre guide vous contactera la veille pour confirmer

Besoin d'aide ?
üìß contact@myowntour.com
üìû +596 696 XX XX XX

Merci de votre confiance !

L'√©quipe Myowntour
    `;
  }

  // Reminder email HTML
  private static getReminderHTML(reminderData: ReminderEmailData): string {
    const { firstName, lastName, excursionName, date, time, meetingPoint, guideName, guidePhone } = reminderData;
    
    return `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Rappel excursion</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 10px 10px; }
          .reminder-details { background: white; padding: 25px; margin: 20px 0; border-radius: 8px; border: 2px solid #ffc107; }
          .detail-row { display: flex; justify-content: space-between; margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px; }
          .detail-label { font-weight: bold; color: #495057; }
          .detail-value { color: #212529; }
          .footer { text-align: center; margin-top: 30px; color: #666; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>‚è∞ Rappel - Votre excursion demain !</h1>
          <p>N'oubliez pas votre excursion</p>
        </div>
        <div class="content">
          <h2>Bonjour ${firstName} ${lastName} !</h2>
          <p>Nous vous rappelons que vous avez une excursion pr√©vue demain. Voici les informations importantes :</p>
          
          <div class="reminder-details">
            <h3>üìã D√©tails de votre excursion</h3>
            <div class="detail-row">
              <span class="detail-label">üèñÔ∏è Excursion :</span>
              <span class="detail-value">${excursionName}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üìÖ Date :</span>
              <span class="detail-value">${date}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">‚è∞ Heure :</span>
              <span class="detail-value">${time}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üë®‚Äçüè´ Guide :</span>
              <span class="detail-value">${guideName}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üìû Contact guide :</span>
              <span class="detail-value">${guidePhone}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">üìç Point de rendez-vous :</span>
              <span class="detail-value">${meetingPoint}</span>
            </div>
          </div>

          <div style="background: #d1ecf1; padding: 20px; border-radius: 8px; border-left: 4px solid #17a2b8; margin: 20px 0;">
            <h4>üìù √Ä ne pas oublier :</h4>
            <ul>
              <li>Pr√©sentez-vous 15 minutes avant l'heure de d√©part</li>
              <li>Apportez une pi√®ce d'identit√©</li>
              <li>V√©rifiez la m√©t√©o et habillez-vous en cons√©quence</li>
              <li>Apportez de l'eau et de la cr√®me solaire</li>
              <li>Votre guide vous contactera ce soir pour confirmer</li>
            </ul>
          </div>

          <div class="footer">
            <p><strong>Besoin d'aide ?</strong><br>
            üìß contact@myowntour.com<br>
            üìû +596 696 XX XX XX</p>
            <p>Profitez bien de votre excursion !<br>
            <strong>L'√©quipe Myowntour</strong></p>
          </div>
        </div>
      </body>
      </html>
    `;
  }

  // Reminder email text
  private static getReminderText(reminderData: ReminderEmailData): string {
    const { firstName, lastName, excursionName, date, time, meetingPoint, guideName, guidePhone } = reminderData;
    
    return `
Bonjour ${firstName} ${lastName} !

Nous vous rappelons que vous avez une excursion pr√©vue demain. Voici les informations importantes :

üìã D√âTAILS DE VOTRE EXCURSION
üèñÔ∏è Excursion : ${excursionName}
üìÖ Date : ${date}
‚è∞ Heure : ${time}
üë®‚Äçüè´ Guide : ${guideName}
üìû Contact guide : ${guidePhone}
üìç Point de rendez-vous : ${meetingPoint}

üìù √Ä NE PAS OUBLIER :
‚Ä¢ Pr√©sentez-vous 15 minutes avant l'heure de d√©part
‚Ä¢ Apportez une pi√®ce d'identit√©
‚Ä¢ V√©rifiez la m√©t√©o et habillez-vous en cons√©quence
‚Ä¢ Apportez de l'eau et de la cr√®me solaire
‚Ä¢ Votre guide vous contactera ce soir pour confirmer

Besoin d'aide ?
üìß contact@myowntour.com
üìû +596 696 XX XX XX

Profitez bien de votre excursion !

L'√©quipe Myowntour
    `;
  }

  // Password reset email HTML
  private static getPasswordResetHTML(resetUrl: string): string {
    return `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>R√©initialisation mot de passe</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 10px 10px; }
          .button { display: inline-block; background: #dc3545; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; margin: 20px 0; }
          .warning { background: #fff3cd; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107; margin: 20px 0; }
          .footer { text-align: center; margin-top: 30px; color: #666; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>üîê R√©initialisation de mot de passe</h1>
          <p>Myowntour</p>
        </div>
        <div class="content">
          <h2>Bonjour !</h2>
          <p>Vous avez demand√© la r√©initialisation de votre mot de passe Myowntour.</p>
          
          <div style="text-align: center;">
            <a href="${resetUrl}" class="button">üîë R√©initialiser mon mot de passe</a>
          </div>

          <div class="warning">
            <h4>‚ö†Ô∏è Important :</h4>
            <ul>
              <li>Ce lien est valide pendant 1 heure seulement</li>
              <li>Si vous n'avez pas demand√© cette r√©initialisation, ignorez cet email</li>
              <li>Votre mot de passe actuel reste inchang√© tant que vous n'en cr√©ez pas un nouveau</li>
            </ul>
          </div>

          <p>Si le bouton ne fonctionne pas, copiez et collez ce lien dans votre navigateur :</p>
          <p style="word-break: break-all; background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace;">${resetUrl}</p>

          <div class="footer">
            <p><strong>Besoin d'aide ?</strong><br>
            üìß contact@myowntour.com<br>
            üìû +596 696 XX XX XX</p>
            <p>L'√©quipe Myowntour</p>
          </div>
        </div>
      </body>
      </html>
    `;
  }

  // Password reset email text
  private static getPasswordResetText(resetUrl: string): string {
    return `
R√©initialisation de mot de passe Myowntour

Vous avez demand√© la r√©initialisation de votre mot de passe.

Cliquez sur ce lien pour cr√©er un nouveau mot de passe :
${resetUrl}

‚ö†Ô∏è Important :
‚Ä¢ Ce lien est valide pendant 1 heure seulement
‚Ä¢ Si vous n'avez pas demand√© cette r√©initialisation, ignorez cet email
‚Ä¢ Votre mot de passe actuel reste inchang√© tant que vous n'en cr√©ez pas un nouveau

Besoin d'aide ? Contactez-nous √† contact@myowntour.com

L'√©quipe Myowntour
    `;
  }

  // Check if Resend is configured
  static isConfigured(): boolean {
    return !!import.meta.env.VITE_RESEND_API_KEY;
  }

  // Get configuration instructions
  static getConfigurationInstructions(): string {
    return `
      üìß Configuration Resend requise :
      
      1. Cr√©ez un compte sur https://resend.com/
      2. Obtenez votre API key depuis le dashboard
      3. Ajoutez VITE_RESEND_API_KEY dans votre fichier .env
      4. Configurez votre domaine d'envoi (optionnel mais recommand√©)
      
      Avantages Resend :
      ‚Ä¢ 100,000 emails/mois GRATUIT
      ‚Ä¢ API s√©curis√©e c√¥t√© serveur
      ‚Ä¢ Templates professionnels
      ‚Ä¢ Suivi des livraisons
      ‚Ä¢ Int√©gration Supabase parfaite
    `;
  }
}
